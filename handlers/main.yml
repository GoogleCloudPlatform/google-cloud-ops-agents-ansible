---
- name: "restart {{ agent_type }} agent"
  service:
    name: "{{ vars[agent_type + '_service_name'] }}"
    state: restarted
    use: "{{ ansible_service_mgr if not testing else 'service' }}"
  when: package_state == 'present' and not ansible_check_mode

# vars['*'] syntax is needed when referencing variables with names containing `-`
- name: restart google-cloud-ops agent
  service:
    name: "{{ vars['google-cloud-ops_service_name'] }}"
    state: restarted
    use: "{{ ansible_service_mgr if not testing else 'service' }}"
  when: package_state == 'present' and not ansible_check_mode
