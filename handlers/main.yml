---
- name: "restart {{ agent_type }} agent"
  service:
    name: "{{ vars[agent_type + '_service_name'] }}"
    state: restarted
  when: package_state == 'present' and not ansible_check_mode and testing is not defined

- name: "restart windows ops-agent agent"
  win_shell: Restart-Service google-cloud-ops-agent -Force
  when: package_state == 'present' and not ansible_check_mode and testing is not defined

- name: "restart windows logging agent"
  win_shell: Restart-Service -Name StackdriverLogging -Force
  when: package_state == 'present' and not ansible_check_mode and testing is not defined
